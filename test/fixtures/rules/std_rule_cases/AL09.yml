rule: AL09

test_pass_no_alias:
    pass_str:
        select
            col_a,
            col_b

test_pass_no_self_alias:
    pass_str:
        select
            col_a,
            col_b as new_col_b

test_pass_no_self_alias_function:
    pass_str:
        select
            max(sum) as max_sum

test_pass_self_alias_quoted_case_change:
    pass_str:
        select
            "COL_A" as "col_a",
            "CoL_b" as "COL_B",
            COL_C as "col_C"

test_pass_literal_alias_bigquery:
    pass_str:
        select
            "COL_A" as `col_a`,
            "COL_B" as col_b
    configs:
        core:
            dialect: bigquery

test_pass_case_sensitivity_change_snowflake:
    # Default case for unquoted alias is uppercase in Snowflake.
    # Case-sensitivity is strict while querying
    pass_str:
        select
            "COL_A" as "col_a",
            col_b as "col_b",
            "col_c" as col_c
    configs:
        core:
            dialect: snowflake

test_pass_case_sensitivity_change_oracle:
    # Default case for unquoted alias is uppercase in Oracle.
    # Case-sensitivity is strict while querying
    pass_str:
        select
            "COL_A" as "col_a",
            col_b as "col_b",
            "col_c" as col_c
    configs:
        core:
            dialect: oracle

test_pass_case_change_bigquery:
    pass_str:
        select
            col_a as `col_A`,
            `col_b` as `col_B`
    configs:
        core:
            dialect: bigquery

# Cases where the rule fails
test_fail_self_alias:
    fail_str:
        select
            col_a as col_a,
            col_b col_b
    fix_str:
        select
            col_a,
            col_b

test_fail_self_alias_colum_quoted:
    fail_str:
        select
            "col_a" as "col_a",
            "col_b" as col_b
    fix_str:
        select
            "col_a",
            "col_b"

test_fail_self_alias_alias_quoted:
    # It is possible that the case of original column be different than "column".
    # That would mean that it's not self-alias. However, it is recommended to
    # show the orginal case of the column while changing case-sensitivity.
    fail_str:
        select
            column as "column"


test_fail_self_alias_snowflake:
    fail_str:
        select
            "CoL" as "CoL"
    fix_str:
        select
            "CoL"
    configs:
        core:
            dialect: snowflake

test_fail_self_alias_and_table_aliased:
    fail_str:
        select
            a.col_a as col_a
        from foo as a

    fix_str:
        select
            a.col_a
        from foo as a

test_fail_case_change_without_quoted_alias:
    fail_str:
        select
            col_a as COL_A

test_fail_case_change_without_quoted_alias_implicit:
    fail_str:
        select
            col_a col_A

test_fail_case_change_without_quoted_alias_with_quoted_column:
    fail_str:
        select
            "col_A" as col_a

test_fail_case_change_without_quoted_alias_bigquery:
    fail_str:
        select
            `col_a` as col_A,
            col_b as col_B
    configs:
        core:
            dialect: bigquery
