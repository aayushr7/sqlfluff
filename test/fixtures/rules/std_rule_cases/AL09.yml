rule: AL09

test_pass_no_alias:
    pass_str:
        select
            col_a,
            col_b
        from foo

test_pass_no_self_alias:
    pass_str:
        select
            col_a,
            col_b as new_col_b
        from foo

test_pass_no_self_alias_function:
    pass_str:
        select
            max(sum) as max_sum
        from foo

test_pass_self_alias_sensitivity_change:
    # Renaming the column name from case-sensitive to case-insensitive
    pass_str:
        select
            "col_a" as col_a,
            col_b as "col_b"
        from foo

test_pass_self_alias_quoted_case_change:
    pass_str:
        select
            "COL_A" as "col_a",
            "CoL_b" as "COL_B"
        from
            foo

test_pass_literal_alias_bigquery:
    pass_str:
        select
            "COL_A" as `col_a`,
            "COL_B" AS col_b
        from foo
    configs:
        core:
            dialect: bigquery

# Cases where the rule fails
test_fail_self_alias:
    fail_str:
        select
            col_a as col_a,
            col_b col_b
        from foo
    fix_str:
        select
            col_a,
            col_b
        from foo

test_fail_self_alias_quoted:
    fail_str:
        select
            "col" as "col"
        from foo
    fix_str:
        select
            "col"
        from foo

test_fail_self_alias_and_table_aliased:
    fail_str:
        select
            a.col_a as col_a
        from foo as a

    fix_str:
        select
            a.col_a
        from foo as a

test_fail_case_change_without_quoted_alias:
    fail_str:
        select
            col_a as COL_A,
            col_b Col_B
        from foo
    fix_str:
        select
            col_a as "COL_A",
            col_b as "Col_B"
        from foo

test_fail_case_change_without_quoted_alias_bigquery:
    fail_str:
        select
            col_a as COL_A,
            col_b Col_B
        from foo
    fix_str:
        select
            col_a as `COL_A`,
            col_b as `Col_B`
        from foo
    configs:
        core:
            dialect: bigquery
